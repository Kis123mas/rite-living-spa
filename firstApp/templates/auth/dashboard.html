{% extends 'auth/maindash.html' %}
{% load static %}

{% block content %}
<div class="main">
    {% include 'auth/nav.html' %}
    
    
    <!-- <main class="content px-4 py-3"> -->
    <main class="content px-4 py-3" style="max-height: 90vh; overflow-y: auto;">
        {% if request.user.is_secretary or request.user.is_not_secretary or request.user.is_superuser %}
        <div class="mb-4">
            <h2>Dashboard</h2>
            <p class="text-muted">Manage and view your schedule in one place.</p>
        </div>
        {% endif %}

        <!-- for secretary only -->
        {% if user.is_secretary %}
        <div class="container-fluid py-1">  <!-- Reduced the padding even more -->
            <div class="container">
                
                <!-- Row: Service Stats -->
                <div class="row mb-2">  <!-- Reduced margin-bottom even more -->
                    <div class="col-md-6">
                        <div class="card shadow-sm">
                            <div class="card-body">
                                <h5 class="card-title" style="font-size: 0.8rem;">üßë‚Äçüíº Service Stats by Staff</h5>  <!-- Reduced font size more -->
                        
                                <!-- Month & Year Filter -->
                                <form method="get" class="mb-1">  <!-- Reduced margin-bottom here -->
                                    <label for="month" style="font-size: 0.8rem;">Month:</label>  <!-- Reduced font size -->
                                    <select name="month" id="month" class="form-select d-inline" style="font-size: 0.8rem; height: 30px; width: 100px;">
                                        {% for i in months %}
                                            <option value="{{ forloop.counter }}" {% if forloop.counter == month %}selected{% endif %}>
                                                {{ i }}
                                            </option>
                                        {% endfor %}
                                    </select>
                        
                                    <label for="year" class="ms-1" style="font-size: 0.8rem;">Year:</label>  <!-- Reduced font size -->
                                    <select name="year" id="year" class="form-select d-inline w-auto" style="font-size: 0.8rem;">
                                        <option value="2023" {% if year == 2023 %}selected{% endif %}>2023</option>
                                        <option value="2024" {% if year == 2024 %}selected{% endif %}>2024</option>
                                        <option value="2025" {% if year == 2025 %}selected{% endif %}>2025</option>
                                    </select>
                        
                                    <button type="submit" class="btn btn-primary ms-1" style="font-size: 0.8rem;">Filter</button>  <!-- Reduced font size -->
                                </form>
                        
                                <!-- Pie Chart for Service Stats -->
                                <canvas id="staffServiceChart" height="100"></canvas>  <!-- Reduced chart height even further -->
                            </div>
                        </div>
                    </div>
                
                    <!-- Bar Chart for User Registrations -->
                    <div class="col-md-6">
                        <div class="card shadow-sm">
                            <div class="card-body">
                                <h5 class="card-title" style="font-size: 0.8rem;">üë§ User Growth</h5>
                        
                                <!-- Bar Chart for User Registrations -->
                                <canvas id="userGrowthChart" height="150"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
        
            </div>
        </div>
        {% endif %}


        <!-- for staffs only -->
        {% if user.is_not_secretary %}

        <div class="container my-4">
            <div class="card shadow-sm border-0 rounded-4">
                <div class="card-body">
                    <h4 class="card-title mb-3">
                        <i class="fa-solid fa-scale-balanced text-primary me-2"></i>
                        Company Code of Conduct
                    </h4>
                    <p class="text-muted mb-4">All staff members are expected to adhere to the following professional standards.</p>
        
                    <ul class="list-group list-group-flush">
                        <li class="list-group-item">
                            <i class="fa-solid fa-user-check text-success me-2"></i>
                            <strong>Professionalism:</strong> Maintain a respectful and courteous demeanor with clients and colleagues at all times.
                        </li>
                        <li class="list-group-item">
                            <i class="fa-solid fa-clock text-warning me-2"></i>
                            <strong>Punctuality:</strong> Arrive on time for all scheduled shifts and appointments.
                        </li>
                        <li class="list-group-item">
                            <i class="fa-solid fa-user-shield text-info me-2"></i>
                            <strong>Confidentiality:</strong> Respect the privacy of clients. Do not disclose any personal or treatment-related information.
                        </li>
                        <li class="list-group-item">
                            <i class="fa-solid fa-hands-bubbles text-secondary me-2"></i>
                            <strong>Cleanliness:</strong> Maintain a clean and hygienic workspace at all times.
                        </li>
                        <li class="list-group-item">
                            <i class="fa-solid fa-people-group text-danger me-2"></i>
                            <strong>Teamwork:</strong> Collaborate and communicate effectively with team members for smooth operations.
                        </li>
                        <li class="list-group-item">
                            <i class="fa-solid fa-phone text-primary me-2"></i>
                            <strong>Communication:</strong> Inform management promptly about any concerns, emergencies, or scheduling issues.
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        

        {% endif %}


        {% if not request.user.is_secretary and not request.user.is_not_secretary and not request.user.is_superuser %}

        <div class="container my-3">
            <!-- Welcome Section -->
            <div class="text-center mb-5">
                <h2 class="fw-bold animate-fade-in">Welcome to Rite Living Spa üå∫</h2>
                <p class="lead text-muted animate-fade-in-slow">
                    Relax, rejuvenate, and shine. Let‚Äôs pamper you with our best products and spa treatments.
                </p>
            </div>

            <!-- Action Cards: Shop & Book -->
            <div class="row g-4 justify-content-center">
                <!-- Shop Now Card -->
                <div class="col-md-5">
                    <div class="card border-0 shadow-lg animate-slide-up h-100">
                        <div class="card-body text-center p-4">
                            <img src="{%static 'firstApp/images/logo.png' %}" alt="Shop" class="img-fluid mb-3" style="max-height: 160px;">
                            <h5 class="fw-semibold">Shop Spa Products</h5>
                            <p class="text-muted">Browse our curated collection of spa and skincare products made just for you.</p>
                            <a href="#" class="btn btn-brand mt-2">Go to Store</a>
                        </div>
                    </div>
                </div>

                <!-- Book Session Card -->
                <div class="col-md-5">
                    <div class="card border-0 shadow-lg animate-slide-up h-100">
                        <div class="card-body text-center p-4">
                            <img src="{% static 'img/spa-booking.png' %}" alt="Book Session" class="img-fluid mb-3" style="max-height: 160px;">
                            <h5 class="fw-semibold">Book a Spa Session</h5>
                            <p class="text-muted">Choose a date and time that works for you, and we‚Äôll handle the rest.</p>
                            <a href="#" class="btn btn-success mt-2">Book Now</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Animations -->
        <style>
            @keyframes fadeIn {
                from { opacity: 0; transform: translateY(-10px); }
                to { opacity: 1; transform: translateY(0); }
            }

            @keyframes slideUp {
                from { opacity: 0; transform: translateY(30px); }
                to { opacity: 1; transform: translateY(0); }
            }

            .animate-fade-in {
                animation: fadeIn 1s ease-in-out forwards;
            }

            .animate-fade-in-slow {
                animation: fadeIn 2s ease-in-out forwards;
            }

            .animate-slide-up {
                animation: slideUp 1.5s ease-in-out forwards;
            }

            .btn-brand {
                background-color: #c084fc;
                color: white;
            }

            .btn-brand:hover {
                background-color: #a855f7;
                color: white;
            }
        </style>
        {% endif %}



        {% if user.is_admin %}

        {% endif %}
    </main>

    
    
</div>

<!-- Chart.js CDN -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
        
<!-- Chart.js CDN -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
        
<script>
    // Pie Chart for Service Stats
    const staffServiceData = {
        labels: JSON.parse('{{ staff_labels|escapejs }}'),
        datasets: [{
            label: 'Services Rendered',
            data: JSON.parse('{{ staff_data|escapejs }}'),
            backgroundColor: [
                '#007bff', '#6610f2', '#6f42c1', '#e83e8c',
                '#fd7e14', '#20c997', '#17a2b8', '#ffc107'
            ],
            borderWidth: 1
        }]
    };

    new Chart(document.getElementById('staffServiceChart').getContext('2d'), {
        type: 'pie',
        data: staffServiceData,
        options: {
            responsive: true
        }
    });

</script>
{% endblock %}
